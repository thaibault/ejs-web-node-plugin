'use strict';
(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b(require('babel-runtime/helpers/classCallCheck'),require('babel-runtime/core-js/get-iterator'),require('babel-runtime/core-js/promise'),require('babel-runtime/regenerator'),require('babel-runtime/helpers/asyncToGenerator'),require('clientnode'),require('ejs'),require('fs'),require('path'),require('web-node/pluginAPI.compiled'),function(){try{return require('source-map-support/register')}catch(a){}}()):'function'==typeof define&&define.amd?define('templatewebnodeplugin',['babel-runtime/helpers/classCallCheck','babel-runtime/core-js/get-iterator','babel-runtime/core-js/promise','babel-runtime/regenerator','babel-runtime/helpers/asyncToGenerator','clientnode','ejs','fs','path','web-node/pluginAPI.compiled','source-map-support/register'],b):'object'==typeof exports?exports.templatewebnodeplugin=b(require('babel-runtime/helpers/classCallCheck'),require('babel-runtime/core-js/get-iterator'),require('babel-runtime/core-js/promise'),require('babel-runtime/regenerator'),require('babel-runtime/helpers/asyncToGenerator'),require('clientnode'),require('ejs'),require('fs'),require('path'),require('web-node/pluginAPI.compiled'),function(){try{return require('source-map-support/register')}catch(a){}}()):a.templatewebnodeplugin=b(a['babel-runtime/helpers/classCallCheck'],a['babel-runtime/core-js/get-iterator'],a['babel-runtime/core-js/promise'],a['babel-runtime/regenerator'],a['babel-runtime/helpers/asyncToGenerator'],a.clientnode,a.ejs,a.fs,a.path,a['web-node/pluginAPI.compiled'],a['source-map-support/register'])})('undefined'==typeof self?this:self,function(a,b,c,d,e,f,g,h,i,j,k){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=0)}([function(a,b,c){a.exports=c(1)},function(a,b,c){'use strict';(function(a,d){function e(a){return a&&a.__esModule?a:{default:a}}var f=c(3),g=e(f),h=c(4),i=e(h),j=c(5),k=e(j),l=c(6),m=e(l),n=c(7),o=e(n),p=c(8),q=e(p),r=c(9),s=e(r),t=c(10),u=e(t),v=c(11),w=e(v),x=c(12),y=e(x);b.__esModule=!0,b.Template=void 0;try{c(13)}catch(a){}var z=b.Template=function(){function b(){(0,o.default)(this,b)}return b.postConfigurationLoaded=function(){var a=(0,m.default)(k.default.mark(function a(c,d,e,f){return k.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c.template.renderAfterConfigurationUpdates&&b.render(null,c,f),a.abrupt('return',c);case 2:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),b.preLoadService=function(a){return a.template={render:b.render.bind(b),renderFactory:b.renderFactory.bind(b)},a},b.shouldExit=function(){var a=(0,m.default)(k.default.mark(function a(c,d){var e,f,g,h=this;return k.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(g in e=[],f=function(a){b.files.hasOwnProperty(a)&&!d.template.inPlaceReplacementPaths.includes(a)&&e.push(new i.default(function(){var b=(0,m.default)(k.default.mark(function b(c,d){var e,f;return k.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return e=a.substring(0,a.length-w.default.extname(a).length),f=!1,b.prev=2,b.next=5,q.default.isFile(e);case 5:f=b.sent,b.next=11;break;case 8:b.prev=8,b.t0=b['catch'](2),d(b.t0);case 11:f?u.default.unlink(e,function(a){return a?d(a):c(e)}):c(f);case 12:case'end':return b.stop();}},b,h,[[2,8]])}));return function(){return b.apply(this,arguments)}}()))},b.files)f(g);return a.next=5,i.default.all(e);case 5:return a.abrupt('return',c);case 6:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),b.getEntryFiles=function(){var a=(0,m.default)(k.default.mark(function a(c,d){var e,f,h,i,j,l,m,n,o,p,r,s;return k.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b.entryFiles||c.template.reloadEntryFiles){a.next=2;break}return a.abrupt('return',b.entryFiles);case 2:return e=d.map(function(a){return a.path}),b.entryFiles={},a.next=6,q.default.walkDirectoryRecursively(c.context.path,function(a){if(a.name.startsWith('.'))return!1;for(var b in c.plugin.directories)if(c.plugin.directories.hasOwnProperty(b)&&w.default.dirname(a.path)===w.default.resolve(c.plugin.directories[b].path)&&!e.includes(a.path))return!1;for(var d=c.template.locationsToIgnore,f=Array.isArray(d),h=0,d=f?d:(0,g.default)(d);;){var i;if(f){if(h>=d.length)break;i=d[h++]}else{if(h=d.next(),h.done)break;i=h.value}var j=i;if(!j.startsWith('/'))for(var k=e,l=Array.isArray(k),m=0,k=l?k:(0,g.default)(k);;){var n;if(l){if(m>=k.length)break;n=k[m++]}else{if(m=k.next(),m.done)break;n=m.value}var o=n;if(a.path.startsWith(w.default.resolve(o,j)))return!1}else if(a.path.startsWith(w.default.join(c.context.path,j)))return!1}});case 6:a.t0=function(a){return!a.error&&a.stats.isFile()&&0<c.template.extensions.filter(function(b){return a.name.endsWith(b)}).length},f=a.sent.filter(a.t0),h=Array.isArray(f),i=0,f=h?f:(0,g.default)(f);case 11:if(!h){a.next=17;break}if(!(i>=f.length)){a.next=14;break}return a.abrupt('break',25);case 14:j=f[i++],a.next=21;break;case 17:if(i=f.next(),!i.done){a.next=20;break}return a.abrupt('break',25);case 20:j=i.value;case 21:l=j,b.entryFiles[l.path]=null;case 23:a.next=11;break;case 25:m=c.template.inPlaceReplacementPaths,n=Array.isArray(m),o=0,m=n?m:(0,g.default)(m);case 26:if(!n){a.next=32;break}if(!(o>=m.length)){a.next=29;break}return a.abrupt('break',40);case 29:p=m[o++],a.next=36;break;case 32:if(o=m.next(),!o.done){a.next=35;break}return a.abrupt('break',40);case 35:p=o.value;case 36:r=p,b.entryFiles[r]=null;case 38:a.next=26;break;case 40:for(s in b.entryFiles)b.entryFiles.hasOwnProperty(s)&&(b.files[s]=b.entryFiles[s]);return a.abrupt('return',b.entryFiles);case 42:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),b.render=function(){function c(){return e.apply(this,arguments)}var e=(0,m.default)(k.default.mark(function c(e,f,g){var h,j,l,n,o,p,r,t,v,x=this;return k.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:for(h=q.default.extendObject(!0,{basePath:f.context.path},f.template.scope.plain,e||{}),j=['evaluation','execution'],l=0;l<j.length;l++)for(o in n=j[l],f.template.scope[n])f.template.scope[n].hasOwnProperty(o)&&(h[o]=new Function('configuration','currentPath','fileSystem','parser','path','PluginAPI','plugins','require','scope','template','Tools','webNodePath','evaluation'===n?'return '+f.template.scope[n][o]:f.template.scope[n][o])(q.default.copyLimitedRecursively(f,-1,!0),a.cwd(),u.default,s.default,w.default,y.default,g,eval('require'),h,b,q.default,d));return p=q.default.copyLimitedRecursively(f.template.options),h.include=b.renderFactory(f,h,p),c.t0=y.default,c.t1=g,c.t2=f,c.next=10,b.getEntryFiles(f,g);case 10:return c.t3=c.sent,c.t4=h,c.next=14,c.t0.callStack.call(c.t0,'preTemplateRender',c.t1,c.t2,c.t3,c.t4);case 14:for(v in b.entryFiles=c.sent,r=[],t=function(a){b.entryFiles.hasOwnProperty(a)&&r.push(new i.default(function(){var c=(0,m.default)(k.default.mark(function c(d,e){var i,j,l,m,n;return k.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(i=q.default.extendObject({},h),j=f.template.inPlaceReplacementPaths.includes(a),l=j?a:a.substring(0,a.length-w.default.extname(a).length),c.t0=j&&f.template.cacheInPlaceReplacements&&b.entryFiles[a],c.t0){c.next=11;break}if(c.t1=!j&&f.template.cache,!c.t1){c.next=10;break}return c.next=9,q.default.isFile(l);case 9:c.t1=c.sent;case 10:c.t0=c.t1;case 11:if(!c.t0){c.next=16;break}console.info('Template: Use cached file ("'+l+'") '+('for "'+a+'".')),d(l),c.next=21;break;case 16:if(m=q.default.extendObject({},p,{filename:w.default.relative(i.basePath,a)}),'options'in i||(i.options=m),'plugins'in i||(i.plugins=g),n=b.renderFactory(f,i,m)(a),n)try{u.default.writeFile(l,n,{encoding:f.encoding,flag:'w',mode:438},function(a){return a?e(a):d(l)})}catch(a){e(a)}case 21:case'end':return c.stop();}},c,x)}));return function(){return c.apply(this,arguments)}}()))},b.entryFiles)t(v);return c.next=20,i.default.all(r);case 20:return c.next=22,y.default.callStack('postTemplateRender',g,f,h,b.entryFiles);case 22:return c.abrupt('return',c.sent);case 23:case'end':return c.stop();}},c,this)}));return c}(),b.renderFactory=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return c.basePath||(c.basePath=a.context.path),d.preCompiledTemplateFileExtensions||(d.preCompiledTemplateFileExtensions=['.js']),function(e){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},h=q.default.copyLimitedRecursively(d);delete h.client,h=q.default.extendObject(!0,{encoding:'utf-8'},h,f.options||{});var i=q.default.extendObject({},c);e=w.default.resolve(c.basePath,e),h.filename=w.default.relative(c.basePath,e),i.basePath=w.default.dirname(e),i.include=b.renderFactory(a,i,h),i.options=h,i.scope=i,q.default.extendObject(i,f);for(var j=null,k=[''].concat(a.template.extensions),l=Array.isArray(k),m=0,k=l?k:(0,g.default)(k);;){var n;if(l){if(m>=k.length)break;n=k[m++]}else{if(m=k.next(),m.done)break;n=m.value}var o=n;if(q.default.isFileSync(e+o)){j=e+o;break}}if(j){if(a.template.reloadSourceContent&&!a.template.inPlaceReplacementPaths.includes(e)||!(b.files.hasOwnProperty(j)&&b.files[j]))if(h.preCompiledTemplateFileExtensions.includes(w.default.extname(j)))try{b.files[j]=eval('require')(j)}catch(a){throw new Error('Error occurred during loading script module: "'+j+'": '+q.default.representObject(a))}else{var p;try{p=u.default.readFileSync(j,{encoding:h.encoding})}catch(a){throw new Error('Error occurred during loading template file "'+j+'" from file system:'+(' '+q.default.representObject(a)))}try{b.files[j]=s.default.compile(p,h)}catch(a){throw new Error('Error occurred during compiling template file "'+j+'" with base path "'+(i.basePath+'": ')+q.default.representObject(a))}}try{return b.files[j](i)}catch(a){var r='';try{r='scope '+q.default.representObject(i)+' against'}catch(a){}throw new Error('Error occurred during running template '+(r+'file "'+j+'": ')+q.default.representObject(a))}}throw new Error('Given template file "'+h.filename+'" couldn\'t be resolved (with known extensions: "'+(a.template.extensions.join('", "')+'") in "')+(c.basePath+'".'))}},b}();z.files={},b.default=z}).call(b,c(2),'/')},function(a){function b(){throw new Error('setTimeout has not been defined')}function c(){throw new Error('clearTimeout has not been defined')}function d(a){if(j===setTimeout)return setTimeout(a,0);if((j===b||!j)&&setTimeout)return j=setTimeout,setTimeout(a,0);try{return j(a,0)}catch(b){try{return j.call(null,a,0)}catch(b){return j.call(this,a,0)}}}function e(a){if(k===clearTimeout)return clearTimeout(a);if((k===c||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(a);try{return k(a)}catch(b){try{return k.call(null,a)}catch(b){return k.call(this,a)}}}function f(){o&&m&&(o=!1,m.length?n=m.concat(n):p=-1,n.length&&g())}function g(){if(!o){var a=d(f);o=!0;for(var b=n.length;b;){for(m=n,n=[];++p<b;)m&&m[p].run();p=-1,b=n.length}m=null,o=!1,e(a)}}function h(a,b){this.fun=a,this.array=b}function i(){}var j,k,l=a.exports={};(function(){try{j='function'==typeof setTimeout?setTimeout:b}catch(a){j=b}try{k='function'==typeof clearTimeout?clearTimeout:c}catch(a){k=c}})();var m,n=[],o=!1,p=-1;l.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];n.push(new h(a,b)),1!==n.length||o||d(g)},h.prototype.run=function(){this.fun.apply(null,this.array)},l.title='browser',l.browser=!0,l.env={},l.argv=[],l.version='',l.versions={},l.on=i,l.addListener=i,l.once=i,l.off=i,l.removeListener=i,l.removeAllListeners=i,l.emit=i,l.prependListener=i,l.prependOnceListener=i,l.listeners=function(){return[]},l.binding=function(){throw new Error('process.binding is not supported')},l.cwd=function(){return'/'},l.chdir=function(){throw new Error('process.chdir is not supported')},l.umask=function(){return 0}},function(a){a.exports=b},function(a){a.exports=c},function(a){a.exports=d},function(a){a.exports=e},function(b){b.exports=a},function(a){a.exports=f},function(a){a.exports=g},function(a){a.exports=h},function(a){a.exports=i},function(a){a.exports=j},function(a){if('undefined'==typeof k){var b=new Error('Cannot find module "source-map-support/register"');throw b.code='MODULE_NOT_FOUND',b}a.exports=k}])});